{#
 * ---------------------------------------------------------------------
 * GLPI - Gestionnaire Libre de Parc Informatique
 * Copyright (C) 2015-2018 Teclib' and contributors.
 *
 * http://glpi-project.org
 *
 * based on GLPI - Gestionnaire Libre de Parc Informatique
 * Copyright (C) 2003-2014 by the INDEPNET Development Team.
 *
 * ---------------------------------------------------------------------
 *
 * LICENSE
 *
 * This file is part of GLPI.
 *
 * GLPI is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * GLPI is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with GLPI. If not, see <http://www.gnu.org/licenses/>.
 * ---------------------------------------------------------------------
 #}
{% extends "glpi.twig" %}

{% block title %}{% trans "Authentication" %}{% endblock %}
{% block html_class %}loginpage{% endblock %}
{% block content %}
   <div id='firstboxlogin'>
      <div id='logo_login'></div>
      <div id='text-login'>
         {# echo nl2br(Toolbox::unclean_html_cross_side_scripting_deep($CFG_GLPI['text_login'])); #}
      </div>

      <div id='boxlogin'>
         <form action='{{ path_for('login') }}' method='post'>

   {#
   // Other CAS
   if (isset($_GET["noAUTO"])) {
      echo "<input type='hidden' name='noAUTO' value='1' />";
   }
   // redirect to ticket
   if (isset($_GET["redirect"])) {
      Toolbox::manageRedirect($_GET["redirect"]);
      echo '<input type="hidden" name="redirect" value="'.$_GET['redirect'].'"/>';
   }#}
            <p class="login_input">
               <input type="text" name="{# '.$namfield.' #}" id="login_name" required="required"
                placeholder="{% trans "Login" %}" autofocus="autofocus" />
               <span class="login_img"></span>
            </p>
            <p class="login_input">
               <input type="password" name="{# '.$pwdfield.' #}" id="login_password" required="required"
                placeholder="{% trans "Password" %}"  />
               <span class="login_img"></span>
            </p>
            {%if CFG_GLPI.login_remember_time %}
               <p class="login_input">
                  <label for="login_remember">
                     <input type="checkbox" name="{# '.$rmbfield.' #}" id="login_remember" {% if CFG_GLPI.login_remember_default %} checked="checked"{% endif %} />
                     {% trans "Remember me" %}
                  </label>
               </p>
            {% endif %}
            <p class="login_input">
               <input type="submit" name="submit" value="{% trans "Login" %}" class="submit" />
            </p>
{% include "elements/hidden.twig" with {'id': '_csrf', 'name': '_csrf', 'value': ''} %}
{#
   if ($CFG_GLPI["notifications_mailing"]
       && countElementsInTable('glpi_notifications',
                               "`itemtype`='User'
                                AND `event`='passwordforget'
                                AND `is_active`=1")) {
      echo '<a id="forget" href="front/lostpassword.php?lostpassword=1">'.
             __('Forgotten password?').'</a>';
   }
   Html::closeForm();

   echo "<script type='text/javascript' >\n";
   echo "document.getElementById('login_name').focus();";
   echo "</script>";

   echo "</div>";  // end login box


   echo "<div class='error'>";
   echo "<noscript><p>";
   echo __('You must activate the JavaScript function of your browser');
   echo "</p></noscript>";

   if (isset($_GET['error']) && isset($_GET['redirect'])) {
      switch ($_GET['error']) {
         case 1 : // cookie error
            echo __('You must accept cookies to reach this application');
            break;

         case 2 : // GLPI_SESSION_DIR not writable
            echo __('Checking write permissions for session files');
            break;

         case 3 :
            echo __('Invalid use of session ID');
            break;
      }
   }
   echo "</div>";

   // Display FAQ is enable
   if ($CFG_GLPI["use_public_faq"]) {
      echo '<div id="box-faq">'.
            '<a href="front/helpdesk.faq.php">[ '.__('Access to the Frequently Asked Questions').' ]';
      echo '</a></div>';
   }

   echo "<div id='display-login'>";
   Plugin::doHook('display_login');
   echo "</div>";


   echo "</div>"; // end contenu login
#}

   {#if (GLPI_DEMO_MODE) {
      echo "<div class='center'>";
      Event::getCountLogin();
      echo "</div>";
   }#}

{% endblock %}
